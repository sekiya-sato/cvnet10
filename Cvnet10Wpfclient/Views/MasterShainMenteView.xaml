<helpers:BaseWindow
    x:Class="Cvnet10Wpfclient.Views.MasterShainMenteView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:helpers="clr-namespace:Cvnet10Wpfclient.Helpers"
    xmlns:vm="clr-namespace:Cvnet10Wpfclient.ViewModels"
    Title="{Binding Title}"
    Width="1044"
    Height="760"
    FontSize="18"
    Foreground="{DynamicResource MaterialDesignBody}"
    Background="{DynamicResource AppCommonBackgroundBrush}"
    TextOptions.TextFormattingMode="Display"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <helpers:BaseWindow.DataContext>
        <vm:MasterShainMenteViewModel />
    </helpers:BaseWindow.DataContext>

    <behaviors:Interaction.Triggers>
        <behaviors:EventTrigger EventName="ContentRendered">
            <behaviors:InvokeCommandAction Command="{Binding InitCommand}" />
        </behaviors:EventTrigger>
    </behaviors:Interaction.Triggers>

    <helpers:BaseWindow.InputBindings>
        <KeyBinding Command="{Binding DoUpdateCommand}" Gesture="F2" />
        <KeyBinding Command="{Binding DoDeleteCommand}" Gesture="F3" />
        <KeyBinding Command="{Binding DoInsertCommand}" Gesture="F4" />
        <KeyBinding Command="{Binding DoListCommand}" Gesture="F5" />
        <KeyBinding Command="{Binding DoOutputJsonCommand}" Gesture="F6" />
    </helpers:BaseWindow.InputBindings>

    <Grid x:Name="grid0">
        <Grid Width="{Binding ActualWidth, ElementName=grid0, Mode=OneWay}" Height="{Binding ActualHeight, ElementName=grid0, Mode=OneWay}">
            <Grid.RowDefinitions>
                <RowDefinition Height="12*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="88*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="45*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="55*" />
            </Grid.ColumnDefinitions>

            <Grid Grid.Row="0" Grid.Column="0">
                <Button Width="70" Height="30" Margin="10,10,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                        Background="Gray" Command="{Binding ExitCommand}" Content="閉じる" />
                <Button Width="110" Height="30" Margin="120,10,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                        Command="{Binding DoListCommand}" Content="一覧取得 F5" />
                <Button Width="110" Height="30" Margin="240,10,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                        Command="{Binding DoOutputJsonCommand}" Content="JSON出力 F6" />
                <Label Height="34" Margin="20,49,99,0" VerticalAlignment="Top"
                       Content="{Binding Title, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"
                       FontSize="14" />
                <materialDesign:PackIcon Width="62" Height="70" Margin="370,10,0,0"
                                         Foreground="Blue" Kind="AccountBox" />
            </Grid>

            <GridSplitter Grid.Row="1" Grid.ColumnSpan="3" Height="3" HorizontalAlignment="Stretch" VerticalAlignment="Center" Background="DarkGray" />
            <GridSplitter Grid.RowSpan="3" Grid.Column="1" Width="3" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="DarkGray" />

            <Grid Grid.Row="2" Grid.Column="0">
                <DataGrid x:Name="ShainGrid"
                          helpers:DataGridScrollAssistant.AutoScrollToSelectedItem="True"
                          d:ItemsSource="{d:SampleData ItemCount=5}"
                          FrozenColumnCount="2"
                          IsReadOnly="True"
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.VirtualizationMode="Recycling"
                          EnableRowVirtualization="True"
                          IsSynchronizedWithCurrentItem="True"
                          Style="{StaticResource MaterialDesignDataGrid}"
                          HorizontalGridLinesBrush="White"
                          GridLinesVisibility="Horizontal"
                          ItemsSource="{Binding ListData}"
                          SelectedItem="{Binding Current}"
                          AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="コード" Binding="{Binding Code}" Width="100" />
                        <DataGridTextColumn Header="名前" Binding="{Binding Name}" Width="200" />
                        <DataGridTextColumn Header="略称" Binding="{Binding Ryaku}" Width="160" />
                        <DataGridTextColumn Header="カナ" Binding="{Binding Kana}" Width="160" />
                        <DataGridTextColumn Header="メール" Binding="{Binding Mail}" Width="220" />
                        <DataGridTextColumn Header="店舗" Binding="{Binding VTenpo.Name}" Width="140" />
                        <DataGridTextColumn Header="部門" Binding="{Binding VBumon.Name}" Width="140" />
                    </DataGrid.Columns>
                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
                            <Setter Property="Background" Value="Black" />
                            <Setter Property="Foreground" Value="White" />
                            <Setter Property="BorderThickness" Value="0.5" />
                        </Style>
                    </DataGrid.ColumnHeaderStyle>
                </DataGrid>
            </Grid>

            <Grid Grid.Row="0" Grid.Column="2">
                <Button Width="100" Height="30" Margin="10,10,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                        Background="Purple" Command="{Binding DoUpdateCommand}" Content="修正 F2" />
                <Button Width="100" Height="30" Margin="130,10,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                        Background="Purple" Command="{Binding DoDeleteCommand}" Content="削除 F3" />
                <Button Width="100" Height="30" Margin="250,10,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"
                        Background="Purple" Command="{Binding DoInsertCommand}" Content="追加 F4" />
                <Label Height="40" Margin="383,10,0,0" VerticalAlignment="Top"
                       Content="{Binding Count}" ContentStringFormat="{}件数={0:N0}" />
                <TextBlock Height="34" Margin="24,55,0,0" VerticalAlignment="Top" FontSize="16"
                           Foreground="{DynamicResource MaterialDesignBody}" TextWrapping="Wrap" Text="{Binding Message}" />
            </Grid>

            <Grid Margin="10" Grid.Row="2" Grid.Column="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="30*" />
                    <ColumnDefinition Width="70*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Content="コード" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="0" Grid.Column="1" Height="40" Margin="10,20,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" Text="{Binding CurrentEdit.Code}" TextWrapping="Wrap" />

                <Label Grid.Row="1" Content="名前" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="1" Grid.Column="1" Height="40" Margin="10,20,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" Text="{Binding CurrentEdit.Name}" TextWrapping="Wrap" />

                <Label Grid.Row="2" Content="略称" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="2" Grid.Column="1" Height="40" Margin="10,20,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" Text="{Binding CurrentEdit.Ryaku}" TextWrapping="Wrap" />

                <Label Grid.Row="3" Content="カナ" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="3" Grid.Column="1" Height="40" Margin="10,20,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" Text="{Binding CurrentEdit.Kana}" TextWrapping="Wrap" />

                <Label Grid.Row="4" Content="メール" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="4" Grid.Column="1" Height="40" Margin="10,20,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" Text="{Binding CurrentEdit.Mail}" TextWrapping="Wrap" />

                <Label Grid.Row="5" Content="店舗" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />

                <helpers:SearchTextBox  Grid.Row="5" Grid.Column="1" 
                    Width="135"
                    Height="40"
                    Margin="10,5,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Text="{Binding CurrentEdit.Id_Tenpo, UpdateSourceTrigger=PropertyChanged}"
                    BorderThickness="0,0,0,1"
                    TextHorizontalContentAlignment="Left" 
                    Command="{Binding DoSelectTenpoCommand}">
                    <helpers:SearchTextBox.Style>
                        <Style TargetType="{x:Type helpers:SearchTextBox}">
                            <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Window}}" />
                            <Setter Property="Background" Value="{Binding Background, RelativeSource={RelativeSource AncestorType=Window}}" />
                            <Setter Property="ButtonBackground" Value="{DynamicResource HeaderBackgroundBrush}"/>
                        </Style>
                    </helpers:SearchTextBox.Style>
                </helpers:SearchTextBox>


                <Label Grid.Row="6" Content="店舗名" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="6" Grid.Column="1" Height="40" Margin="10,10,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" IsReadOnly="True" TextWrapping="Wrap">
                    <TextBox.Text>
                        <MultiBinding StringFormat="{}[{0}] {1}">
                            <Binding Path="CurrentEdit.VTenpo.Cd" />
                            <Binding Path="CurrentEdit.VTenpo.Mei" />
                        </MultiBinding>
                    </TextBox.Text>
                </TextBox>

                <Label Grid.Row="7" Content="部門Id" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <helpers:SearchTextBox  Grid.Row="7" Grid.Column="1" 
                    Width="135"
                    Height="40"
                    Margin="10,5,0,0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Text="{Binding CurrentEdit.Id_Bumon, UpdateSourceTrigger=PropertyChanged}"
                    BorderThickness="0,0,0,1"
                    TextHorizontalContentAlignment="Left" 
                    Command="{Binding DoSelectBumonCommand}">
                    <helpers:SearchTextBox.Style>
                        <Style TargetType="{x:Type helpers:SearchTextBox}">
                            <Setter Property="Foreground" Value="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Window}}" />
                            <Setter Property="Background" Value="{Binding Background, RelativeSource={RelativeSource AncestorType=Window}}" />
                            <Setter Property="ButtonBackground" Value="{DynamicResource HeaderBackgroundBrush}"/>
                        </Style>
                    </helpers:SearchTextBox.Style>
                </helpers:SearchTextBox>
                <Label Grid.Row="8" Content="部門名" Height="40" Margin="15,20,0,0" VerticalAlignment="Top" />
                <TextBox Grid.Row="8" Grid.Column="1" Height="40" Margin="10,10,10,0" VerticalAlignment="Top"
                         Foreground="{DynamicResource MaterialDesignBody}" IsReadOnly="True" TextWrapping="Wrap">
                    <TextBox.Text>
                        <MultiBinding StringFormat="{}[{0}] {1}">
                            <Binding Path="CurrentEdit.VBumon.Cd" />
                            <Binding Path="CurrentEdit.VBumon.Mei" />
                        </MultiBinding>
                    </TextBox.Text>
                </TextBox>
                <TextBlock
                    Grid.Row="9"
                    Grid.Column="1"
                    Height="65"
                    Margin="10,10,0,0"
                    VerticalAlignment="Top"
                    d:Text="登録日&#x0a;修正日"
                    TextWrapping="Wrap">
                    <TextBlock.Text>
                        <MultiBinding StringFormat="{}登録日={0} &#x0a;修正日={1}">
                            <Binding Path="CurrentEdit.VdateC" />
                            <Binding Path="CurrentEdit.VdateU" />
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </Grid>
        </Grid>
    </Grid>
</helpers:BaseWindow>