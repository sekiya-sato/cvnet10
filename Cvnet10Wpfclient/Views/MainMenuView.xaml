<Window x:Class="Cvnet10Wpfclient.Views.MainMenuView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:Cvnet10Wpfclient.ViewModels"
        xmlns:models="clr-namespace:Cvnet10Wpfclient.Models"
        mc:Ignorable="d"
        WindowStartupLocation="CenterScreen"
        Title="{Binding HeaderTitle}"
        Height="780"
        Width="1200"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResizeWithGrip"
        Background="Transparent"
        Icon="pack://application:,,,/cvnet.ico"
        MouseDown="Window_MouseDown">
    <Window.DataContext>
        <vm:MainMenuViewModel />
    </Window.DataContext>
    <Window.Resources>
        <Style x:Key="MaximizeWinBtn" TargetType="Button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Ellipse Fill="#FFCCCCCC" Stroke="#FF888888" StrokeThickness="1"/>
                            <Path Data="M8,8 L24,8 L24,24 L8,24 Z" Stroke="#FF444444" StrokeThickness="2" Fill="Transparent"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <behaviors:Interaction.Triggers>
        <behaviors:EventTrigger EventName="ContentRendered">
            <behaviors:InvokeCommandAction Command="{Binding InitCommand}" />
        </behaviors:EventTrigger>
    </behaviors:Interaction.Triggers>

    <Border CornerRadius="40" Background="{StaticResource OuterWindowBackground}" Padding="9">
        <Border CornerRadius="24" Background="{StaticResource InnerWindowBackground}" BorderThickness="2">
            <Border.BorderBrush>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="{StaticResource winBorderColor1}" Offset="0" />
                    <GradientStop Color="{StaticResource winBorderColor2}" Offset="0.6" />
                    <GradientStop Color="{StaticResource winBorderColor3}" Offset="1" />
                </LinearGradientBrush>
            </Border.BorderBrush>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Header -->
                <Grid Grid.Row="0" Margin="24,16,24,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{Binding HeaderTitle}"
                                   Foreground="{StaticResource TitleColor}"
                                   FontSize="28"
                                   FontWeight="Bold" />
                        <TextBlock Text="{Binding SubTitle}"
                                   Foreground="{StaticResource SubTitleColor}"
                                   FontSize="14" Padding="8,0,0,0"
                                   Opacity="0.6" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,12,0">
                        <Border Style="{StaticResource StatusChip}" Margin="0,0,8,0">
                            <StackPanel Orientation="Vertical">
                                <TextBlock Text="JWT Expire" Style="{StaticResource MetricLabel}" />
                                <TextBlock Text="{Binding ExpireDate}" Foreground="{StaticResource plainTextColor0}" />
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource StatusChip}">
                            <StackPanel Orientation="Vertical">
                                <TextBlock Text="Status" Style="{StaticResource MetricLabel}" />
                                <TextBlock Text="{Binding StatusMessage}" Foreground="{StaticResource plainTextColor0}" TextWrapping="Wrap" Width="220" />
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Style="{StaticResource MinimizeWinBtn}" Command="{Binding MinimizeCommand}" />
                        <Button Style="{StaticResource MaximizeWinBtn}"
                                Command="{Binding MaximizeCommand}" />
                        <Button Style="{StaticResource CloseWinBtn}" Command="{Binding ExitCommand}" />
                    </StackPanel>
                </Grid>

                <!-- Body -->
                <Grid Grid.Row="1" Margin="24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Navigation -->
                    <Border Grid.Column="0"
                            CornerRadius="18"
                            Background="{StaticResource panelColor}"
                            Padding="10,4,4,4">
                        <StackPanel>
                            <TreeView x:Name="MenuTree"
                                      ItemsSource="{Binding MenuItems}"
                                      ItemContainerStyle="{StaticResource MenuTreeItemStyle}"
                                      Style="{StaticResource MenuTreeView}">
                                <TreeView.ItemTemplate>
                                    <HierarchicalDataTemplate DataType="{x:Type models:MenuData}"
                                                              ItemsSource="{Binding SubItems}">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Header}" FontSize="15" />
                                            <TextBlock Text="{Binding AddInfo}" FontSize="12" Opacity="0.65" />
                                        </StackPanel>
                                    </HierarchicalDataTemplate>
                                </TreeView.ItemTemplate>
                                <behaviors:Interaction.Triggers>
                                    <behaviors:EventTrigger EventName="MouseDoubleClick">
                                        <behaviors:InvokeCommandAction Command="{Binding DoMenuCommand}" />
                                    </behaviors:EventTrigger>
                                    <behaviors:EventTrigger EventName="SelectedItemChanged">
                                        <behaviors:InvokeCommandAction Command="{Binding SelectMenuCommand}"
                                                                      PassEventArgsToCommand="True"
                                                                      EventArgsParameterPath="NewValue" />
                                    </behaviors:EventTrigger>
                                </behaviors:Interaction.Triggers>
                            </TreeView>
                        </StackPanel>
                    </Border>

                    <!-- Main content area -->
                    <Grid Grid.Column="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Horizontal" Grid.Row="0" HorizontalAlignment="Stretch">
                            <Border Style="{StaticResource DashboardCard}" Width="220">
                                <StackPanel>
                                    <TextBlock Text="Online Users" Style="{StaticResource MetricLabel}" />
                                    <TextBlock Text="128" Foreground="{StaticResource TitleColor}" FontSize="32" FontWeight="Bold" />
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardCard}" Width="220">
                                <StackPanel>
                                    <TextBlock Text="Sync Jobs" Style="{StaticResource MetricLabel}" />
                                    <TextBlock Text="42" Foreground="{StaticResource TitleColor}" FontSize="32" FontWeight="Bold" />
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardCard}" Width="220">
                                <StackPanel>
                                    <TextBlock Text="Alerts" Style="{StaticResource MetricLabel}" />
                                    <TextBlock Text="3" Foreground="{StaticResource TitleColor}" FontSize="32" FontWeight="Bold" />
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <Border Grid.Row="1" Style="{StaticResource DashboardCard}" Padding="20">
                            <StackPanel>
                                <TextBlock Text="選択中メニュー" Style="{StaticResource SectionTitleText}" />
                                <TextBlock Text="{Binding SelectedMenu.Header}" Foreground="{StaticResource plainTextColor0}" FontSize="22" FontWeight="Bold" />
                                <TextBlock Text="{Binding SelectedMenu.AddInfo}" Foreground="{StaticResource plainTextColor0}" Opacity="0.8" Margin="0,8,0,0" />
                                <TextBlock Text="メニューを選択すると対応する画面が起動します。"
                                           Foreground="{StaticResource plainTextColor0}"
                                           Opacity="0.7"
                                           Margin="0,16,0,0"
                                           TextWrapping="Wrap" />
                            </StackPanel>
                        </Border>

                        <Border Grid.Row="2" Style="{StaticResource DashboardCard}" Padding="20" Margin="0,16,0,0">
                            <StackPanel>
                                <TextBlock Text="ステータスログ" Style="{StaticResource SectionTitleText}" />
                                <TextBlock Text="{Binding StatusMessage}" Foreground="{StaticResource plainTextColor0}" FontSize="16" TextWrapping="Wrap" />
                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
                <ResizeGrip HorizontalAlignment="Right"
                            VerticalAlignment="Bottom"
                            Margin="0,0,8,8"
                            IsTabStop="False"
                            Opacity="0.6" />
            </Grid>
        </Border>
    </Border>

</Window>
